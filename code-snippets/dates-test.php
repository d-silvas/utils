<?php
$dates = [
    NULL,
    "NULL",
	"",
	" 11 may 1954",
	"/",
	"/02/2020",
	"/02/2025",
	"0",
	"0/0/0000",
	"00/00/00",
	"00/00/0000",
	"00/00/1234",
	"00/00/2020",
	"00/09/2020",
	"000000",
	"0000000",
	"0000000000",
	"00000000000",
	"00000000000000000000",
	"000000000000000000000000",
	"0000000000000000000000000000",
	"01/01/1961",
	"01/01/1965",
	"01/01/1966",
	"01/01/1967",
	"01/01/1968",
	"01/01/1969",
	"01/01/1970",
	"01/01/1972",
	"01/01/1975",
	"01/01/1976",
	"01/08/20",
	"01/08/2016",
	"01/08/2017",
	"01/08/2018",
	"01/08/2019",
	"01/08/2020",
	"01/16",
	"01/21",
	"01dec2018",
	"02",
	"02/01/1955",
	"02/01/1957",
	"02/01/1960",
	"02/01/2019",
	"02/01/2020",
	"02/02/2026",
	"02/02/2036",
	"02/03/19",
	"02/03/1961",
	"02/05/2024",
	"02/05/2027",
	"02/07/2018",
	"02/09/1998",
	"02/09/201",
	"02/09/2016",
	"02/09/2017",
	"02/09/2018",
	"02/09/2019",
	"02/09/2020",
	"02/09/2021",
	"02/09/2025",
	"02/09/2026",
	"02/10/16",
	"02/10/1955",
	"02/10/1970",
	"02/10/1995",
	"02/10/20",
	"02/10/2015",
	"02/10/2016",
	"02/10/2017",
	"02/10/2018",
	"02/12/2018",
	"02/12/2025",
	"02062018",
	"03/01/1960",
	"03/01/1964",
	"03/01/1975",
	"03/01/1980",
	"03/01/1985",
	"03/01/1987",
	"03/01/1991",
	"03/01/1994",
	"03/01/2016",
	"03/01/2017",
	"03/01/2018",
	"03/01/2020",
	"03/01/2021",
	"03/01/2025",
	"03/01/2028",
	"03/03/2021",
	"03/03/2023",
	"03/03/2026",
	"03/04/1956",
	"03/05/2024",
	"03/05/26",
	"03/06/1981",
	"03/06/1986",
	"03/06/1990",
	"03/06/2020",
	"03/06/2021",
	"03/06/2025",
	"03/07/18",
	"03/07/1963",
	"03/09/1979",
	"03/09/1988",
	"03/09/2025",
	"03/09/60",
	"03/092021",
	"03/10/1969",
	"03/10/2019",
	"03/10/2020",
	"03/10/2021",
	"03/10/73",
	"03/11/1957",
	"03/11/1962",
	"03/11/2020",
	"03/11/2021",
	"03/11/2025",
	"03/12/18",
	"03/12/1965",
	"03/12/1968",
	"03/12/2015",
	"03/12/2017",
	"03/12/2018",
	"03/12/2020",
	"03/12/2024",
	"03122018",
	"032019",
	"03july2019",
	"04/01/1971",
	"04/01/1978",
	"04/12/2023",
	"04/12/2026",
	"04/2018",
	"04/2019",
	"04071987",
	"04072025",
	"09/12/2025",
	"09/121962",
	"09/2022",
	"09/22",
	"09061993",
	"1",
	"1 jun 2017",
	"1/11983",
	"10/01/1975",
	"10/02/2017",
	"10/02/2018",
	"10/02/2019",
	"10/02/201990",
	"10/02/2020",
	"10/02/2021",
	"10/02/2022",
	"10/02/2025",
	"10/02/2026",
	"10/03/1940",
	"10/2019",
	"10/4/16",
	"10-07-1984",
	"10122016",
	"11 July 2024",
	"11/01/1961",
	"11/01/1968",
	"12/12/2023",
	"12/2019",
	"12/2022",
	"12031976",
	"12344",
	"13",
	"13/01/1961",
	"13/01/1985",
	"16/20/20",
	"16/6//2018",
	"16062018",
	"17",
	"17 August 2019 ",
	"17/",
	"17/01/1959",
	"17/12/2015",
	"17/12/2017",
	"17/12/2024",
	"17051970",
	"17052019",
	"17082019",
	"18/01/1961",
	"18/01/1973",
	"18/010/2020",
	"18/02/1958",
	"2025",
	"2026",
	"21121980",
	"21st DECEMBER 2016",
	"22/0/2025",
	"31-01-1976",
	"4/8/19",
	"5/3/83",
	"7/071980",
	"7/2/21",
	"7101993",
	"8/11/74",
	"a@a",
	"available upon request",
	"December 2017",
	"N/A",
	"NA",
	"none",
	"Nov2017",
	0,
	1,
	12.786547,
	-986758,
	true,
	false
];

/***
 * - Sometimes wrong dates get parsed (for ex dates in year 0)
 *      so we need maximum and minimum dates.
 * - We need a ! in the format in order to reset hours,
 *      minutes, seconds and milliseconds to 0
 */
$min_date = DateTime::createFromFormat("!d/m/Y", "01/01/1901");
$max_date = DateTime::createFromFormat("!d/m/Y", "31/12/2100");

foreach ($dates as $index => $d) {
    echo "<pre>";
    print_r(get_valid_datetime("!d/m/Y", $d, $min_date, $max_date));
    echo "</pre>";
}



function get_valid_date($format, $date_string, $min_date, $max_date) {
    $parsed = DateTime::createFromFormat($format, $date_string);
    /***
     * The following condition also filters out dates that can't be
     *  parsed (the result from DateTime::createFromFormat() is null)
     */
    if ($parsed < $min_date || $parsed > $max_date) {
        return null;
    }

    return $parsed->format("Y-m-d");
}

function get_valid_datetime($format, $date_string, $min_date, $max_date) {
    $parsed = DateTime::createFromFormat($format, $date_string);

    if ($parsed < $min_date || $parsed > $max_date) {
        return null;
    }

    return $parsed->format("Y-m-d H:i:s.u");
}

